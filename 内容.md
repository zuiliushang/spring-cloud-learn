# Spring Cloud

版本:Dalston.SR3

Spring Cloud是一个快速构建分布式系统中常见模式的工具(例如配置管理，服务发现，断路器，智能路由，微代理，控制总线)。并协调分布式系统boiler plate patterns。使用Spring Cloud的开发人员可以快速创建服务和应用。并且在任何的分布式系统中良好工作，包括开发人员的电脑，数据中心，和管理平台如Cloud Foundry。

## 功能

Spring Cloud 致力于常见情况使用经验和扩展机制来提供良好的决策体验(就是一套方案)。

- 分布式/版本化配置
- 服务注册和发现
- 路由
- 服务到服务调用
- 读取平衡
- 断路器
- 分布式信息

## Cloud Native 应用

Cloud Native 是一种应用发展风格,这种风格更容易适应持续生产和值驱动发展的最佳实践。一个相关的学科是构建12-factor Apps，其中的开发实践与交付和运营目标一致。例如使用声明式编程和管理和监控。Spring Cloud促进这些发展风格通过多种特殊方式并且初始是一系列所有在分布式系统这种被需要或者不被需要的组件的功能。(靠 应该就是说Spring Cloud其实就是注入的一系列功能的bean)。

这些功能在Spring Boot(Spring Cloud的基础)中被覆盖。大部分已经被交付通过Spring Cloud作为两个类库:Spring Cloud Context和Spring Cloud Common。Spring Cloud Context 提供工具和特别的服务为了让```ApplicationContext```实现配置一个Spring Cloud应用的上下文(启动上下文，加密，作用域刷新和环境endpoint)。Spring Cloud Commons 是一组抽象和普通的类使用在不同的Spring Cloud实现(如 Spring Cloud Netflix Spring Cloud Consul)中。

如果你捕获到一个异常叫做"Illegal key size"并且你用的是Sun的JDK，你需要安装Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files.

### Spring Cloud Context: Application Context Services

Spring Boot有一个既定的图纸如何通过Spring构建一个应用:例如它有基础配置文件固定位置。并且通常管理和监控任务。Spring Cloud在最上层添加一些功能可能所有的系统中的组件会用到或者可能需要到。

#### BootStrap Application Context

一个Spring Cloud应用通过创建一个启动上下文来操作，这个上下文是主程序的父上下文。它负责通过外来资源来读取配置属性。并且在本地额外配置文件解密属性。两个上下文共享一个Environment(任何Spring应用的额外属性存放地方)。启动属性被添加在高优先级中，所以他们默认不能在本地配置中被重写；

启动上下文使用一个不同于主应用上下文的定位额外配置的约定。所以可以使用bootstrap.yml而不是用application.yml来保持额外的配置来提供启动和主上下文很好的分离。(就是让你把springcloud的优先级高的配置扔在bootstrap.yml不要扔在application.yml)如：

bootstrap.yml
<pre>
spring:
 application:
  name: foo
 cloud:
  config:
   uri: ${SPRING_CONFIG_URI:http://localhost:8888}
</pre>

一个好主意是设置```spring.application.name```(放在bootstrap.yml或者application.yml)如果你的应用需要来自服务器的任何特定于应用程序的配置。

你可以完整关闭启动通道通过设置```spring.cloud.bootstrap.enabled=false```

#### 应用上下文调层次

如果你通过```SpringApplication```或```SpringApplicationBuilder```创建的引用上下文。那么启动上下文将会添加在这些上下文之上。子上下文会继承到启动上下文的属性。相较于没有Spring Cloud配置的上下文。额外的属性有：

- ```bootstrap```：如果有一个```PropertySourceLocators```在启动上下文被发现那么这个配置就会被```CompositeProertySource```最优先发现，并且为非空的属性。

- ```applicationConfig```:[classpath:bootstrap.yml]\(友好如果一个spring文件激活\)。如果你有一个bootstrap.yml(或properties)然后这些属性将会被用来配置启动上下文。并且他们加入子上下文当它们父上下文被设置。它们的优先级比```application.yml```低。并且其他属性也可以被添加成为创建一个Spring Boot 应用进程的一部分。

